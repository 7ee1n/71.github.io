<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","width":230,"display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="æ›´æ–°ä¸­â€¦ 11.1ï¼šè¿˜åœ¨è°ƒğŸ˜…">
<meta property="og:type" content="article">
<meta property="og:title" content="cve-2021-34730">
<meta property="og:url" content="http://example.com/2021/10/11/ciscoRV130w/index.html">
<meta property="og:site_name" content="71&#39;s blog">
<meta property="og:description" content="æ›´æ–°ä¸­â€¦ 11.1ï¼šè¿˜åœ¨è°ƒğŸ˜…">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2021/10/21/EZMdhXHG1AY3F9I.jpg">
<meta property="og:image" content="https://i.loli.net/2021/10/21/RJ6YcS29befODLw.jpg">
<meta property="og:image" content="https://i.loli.net/2021/10/21/mtSqwnv1XNQzVrA.png">
<meta property="og:image" content="https://i.loli.net/2021/10/22/VSYr3y5qhOeRN16.png">
<meta property="og:image" content="https://i.loli.net/2021/10/29/unrXtxIRD83djv2.png">
<meta property="og:image" content="https://i.loli.net/2021/10/29/2iKeYQBAcLau3XZ.png">
<meta property="og:image" content="https://i.loli.net/2021/10/29/yOYzPERo28aQHCs.png">
<meta property="og:image" content="https://i.loli.net/2021/10/28/cjEa7VLIThBpqsA.png">
<meta property="og:image" content="https://i.loli.net/2021/11/01/8zOBrPe94C2wn6b.png">
<meta property="og:image" content="c:/Users/7ee1n/AppData/Roaming/Typora/typora-user-images/image-20211103213837207.png">
<meta property="article:published_time" content="2021-10-11T03:04:39.000Z">
<meta property="article:modified_time" content="2021-11-04T15:38:19.561Z">
<meta property="article:author" content="7ee1n">
<meta property="article:tag" content="arm">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/10/21/EZMdhXHG1AY3F9I.jpg">

<link rel="canonical" href="http://example.com/2021/10/11/ciscoRV130w/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>cve-2021-34730 | 71's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">71's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">å®é¡˜ç¸±æœªäº† å¥®é¬¥ç¸½ä¸å¤ªæ™š</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/10/11/ciscoRV130w/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="7ee1n">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="71's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          cve-2021-34730
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-10-11 11:04:39" itemprop="dateCreated datePublished" datetime="2021-10-11T11:04:39+08:00">2021-10-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-11-04 23:38:19" itemprop="dateModified" datetime="2021-11-04T23:38:19+08:00">2021-11-04</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iot/" itemprop="url" rel="index"><span itemprop="name">iot</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valineï¼š</span>
    
    <a title="valine" href="/2021/10/11/ciscoRV130w/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/10/11/ciscoRV130w/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <blockquote>
<p>æ›´æ–°ä¸­â€¦ 11.1ï¼šè¿˜åœ¨è°ƒğŸ˜…</p>
</blockquote>
<span id="more"></span>

<h1 id="Pre"><a href="#Pre" class="headerlink" title="Pre"></a>Pre</h1><p>æ¼æ´ä¿¡æ¯ï¼š<a target="_blank" rel="noopener" href="https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-cisco-sb-rv-overflow-htpymMB5">Cisco Small Business RV110Wã€RV130ã€RV130W å’Œ RV215W è·¯ç”±å™¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œå’Œæ‹’ç»æœåŠ¡æ¼æ´</a>ã€‚</p>
<h2 id="UARTè°ƒè¯•"><a href="#UARTè°ƒè¯•" class="headerlink" title="UARTè°ƒè¯•"></a>UARTè°ƒè¯•</h2><p>ä¸Šä¸€ç¯‡ <a target="_blank" rel="noopener" href="https://7ee1n.github.io/2021/09/25/ciscoRV110w-CVE-2020-3331/#more">CVE-2020-3331å¤ç°</a> ç”¨çš„è®¾å¤‡æ˜¯ RV110Wï¼Œåœ¨å‡çº§å›ºä»¶çš„è¿‡ç¨‹ä¸­å‘ç°æœ‰çš„å›ºä»¶æ²¡æœ‰å¼€å¯ telnet æœåŠ¡ï¼Œæœ‰çš„ä¼šé»˜è®¤å¼€å¯ telnet æœåŠ¡ã€‚åº”è¯¥æ˜¯å‚å•†åœ¨æ‰“è¡¥ä¸æ›´æ–°çš„æ—¶å€™åŠ å…¥äº† telnet æœåŠ¡ï¼Œåˆåˆšå¥½æŠŠå“ˆå¸Œæ˜æ–‡å†™siåœ¨å›ºä»¶ä»£ç ä¸­ï¼Œæ‰€ä»¥æ‰èƒ½åœ¨è¾ƒæ–°çš„ç‰ˆæœ¬ä¸­é€šè¿‡ telnet åé—¨è¿œç¨‹è¿æ¥ã€‚</p>
<p>ä½†å¹¶éæ¯å°è®¾å¤‡ã€æ¯ä¸ªç‰ˆæœ¬éƒ½è¿™æ ·ã€‚æœç´¢ <a target="_blank" rel="noopener" href="https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=RV130W">RV130W</a> ï¼Œå‡ ä¹æ‰€æœ‰çš„ CVE é‡Œéƒ½æ²¡æåˆ°è¿‡ telnet åé—¨ã€‚æˆ‘å¾€é‡Œé¢åˆ·äº†å‡ ä¸ªä¸åŒç‰ˆæœ¬çš„å›ºä»¶ï¼Œå‘ç°éƒ½æ²¡æœ‰å¼€å¯ã€‚ä¹Ÿè®¸æ˜¯å‡ºäºå®‰å…¨é—®é¢˜çš„è€ƒè™‘ï¼Œæ²¡æœ‰åŠ ä¸Š telnet åé—¨ã€‚</p>
<p>é™¤äº†è¿œç¨‹è¿æ¥è°ƒè¯•çš„æ–¹å¼å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡ UART å£è¿›è¡Œè°ƒè¯•ã€‚å‚è€ƒï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/44582230">ä¸²å£UARTä¸²è¡Œæ€»çº¿åè®®</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/73875084">è·¯ç”±å™¨åŸºæœ¬è°ƒè¯•ä¸€ UARTå®šä½</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/zeroboundary/article/details/8966586">UARTä¸­çš„ç¡¬ä»¶æµæ§RTSä¸CTS</a></li>
</ul>
<p>RV130W çš„ UART å£ä¸å¤ªå¥½æ‰¾ï¼Œäºæ˜¯æˆ‘æ‹¿ 110W çš„å¯¹æ¯”äº†ä¸‹ã€‚ä¸Šä¸€ç¯‡åšå®¢æåˆ°è¿‡ï¼Œ130W æ¯” 110W çš„ç½‘æ›´å¿«ã€æ›´ç¨³å®šã€æ›´å®‰å…¨ã€‚ä¸‹å›¾ä¸­å·¦è¾¹æ˜¯ RV130Wï¼Œå³è¾¹æ˜¯ RV110Wã€‚ä»ä¸¤è€…ç”¨çš„èŠ¯ç‰‡å‹å·ã€å¤§å°ä»¥åŠæ•´ä¸ªç”µè·¯æ¿çš„è®¾è®¡å¯ä»¥ç›´è§‚åœ°æ„Ÿå—å‡ºåŒºåˆ«ã€‚æ•´ä½“å¸ƒå±€è¿˜æ˜¯å¾ˆç›¸ä¼¼çš„ï¼ˆRV130Wçš„èŠ¯ç‰‡åˆ†å¸ƒæ˜¯æˆ‘æ ¹æ®å°åˆ·çš„å‹å·åˆ¤æ–­çš„ï¼Œæ­£ç¡®ä¸å¦è¿˜å¾—æ‹†é™¤æ•£çƒ­ç‰‡è¿›è¡ŒéªŒè¯ï¼Œè¿™ç‚¹ç•™åˆ°å¤ç°å®Œå†åšï¼‰ï¼Œæœ€ç»ˆæ‰¾åˆ°çš„ UART å£éƒ½æ˜¯åœ¨é—ªå­˜æ—è¾¹ã€‚</p>
<p><img src="https://i.loli.net/2021/10/21/EZMdhXHG1AY3F9I.jpg"></p>
<p>è™½ç„¶ 130W çš„ UART å£é™„è¿‘åªæ ‡æ³¨äº†ç”µé˜»åï¼Œä½†æˆ‘ä»¬å¯ä»¥å€ŸåŠ© æ ‡æ³¨è¯¦ç»†çš„ 110W çš„ UARTå£æ¥åˆ†æã€‚ä»¥ä¸‹æ˜¯ RV110W ä¸Šçš„ UART å£ï¼Œå¯ä»¥åˆ¤æ–­å‡ºå®ƒç”¨çš„æ˜¯ RS232 æ ‡å‡†ã€‚ç„Šä¸Šæ’é’ˆåï¼Œç”¨ä¸‡ç”¨è¡¨åˆ†åˆ«æµ‹ 110W å’Œ 130W çš„ UART å£ï¼Œå‘ç°å®ƒä»¬çš„é¡ºåºæ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯æ•´ä½“æ’åˆ—æ–¹å‘ä¸åŒã€‚è°ƒè¯•çš„æ—¶å€™ç”¨ TXã€RXã€GND å°±å¤Ÿäº†ã€‚</p>
<p><img src="https://i.loli.net/2021/10/21/RJ6YcS29befODLw.jpg"></p>
<p>è¿æ¥åˆ° PC ä¸Šéœ€è¦ç”¨ FT232ã€‚ä¹°çš„æ—¶å€™å•†å®¶ä¸€èˆ¬ä¼šå‘ä½¿ç”¨æ‰‹å†Œï¼Œé‡Œé¢æœ‰é©±åŠ¨å’Œä¸²å£è°ƒè¯•å·¥å…·ã€‚æˆ‘ç”¨çš„æ˜¯ <a target="_blank" rel="noopener" href="https://www.hilgraeve.com/hyperterminal-trial/">HyperTerminal</a> ï¼Œputtyä¹Ÿè¡Œï¼Œæ”¯æŒä¸²å£é€šè®¯çš„éƒ½è¡Œã€‚å—<a target="_blank" rel="noopener" href="https://petri.com/csc_how_to_use_hyperterminal_with_cisco_routers_and_switches#:~:text=HyperTerminal%20can%20also%20be%20used%20to%20telnet%20to,so%20that%20you%20can%20more%20quickly%20configure%20devices.">è¿™ç¯‡æ–‡ç« </a>å½±å“ï¼Œä¸€å¼€å§‹é€‰æ‹©äº†é»˜è®¤çš„æ³¢ç‰¹ç‡9600ï¼Œä¸€ç›´æ¥æ”¶åˆ°ä¹±ç ã€‚åæ¥æƒ³èµ·åœ¨é€šä¿¡åŸç†è¯¾ä¸Šç”¨è¿‡è¿™ä¸ªè½¯ä»¶ï¼Œå…¶å®æ”¶å‘æ•°æ®çš„è¿‡ç¨‹ä¹Ÿæ˜¯å®Œæ•´çš„ä¿¡å·è°ƒåˆ¶-ä¼ è¾“-è§£è°ƒçš„è¿‡ç¨‹ï¼Œæ³¢ç‰¹ç‡ä¸ä¸€è‡´å°±ä¼šå¯¼è‡´è§£è°ƒç»“æœé”™è¯¯ã€‚å› æ­¤é€ä¸ªæ³¢ç‰¹ç‡å°è¯•äº†ä¸€éï¼Œæœ€ç»ˆè¯•å‡ºäº†æ­£ç¡®çš„æ•°å€¼ ã€‚</p>
<p><img src="https://i.loli.net/2021/10/21/mtSqwnv1XNQzVrA.png"></p>
<p>å¼€æœºçš„æ—¶å€™ä¼šæ‰“å°å‡ºä¸€äº›é…ç½®ä¿¡æ¯ã€‚å› æ­¤æˆ‘å…ˆå…³é—­ç”µæºï¼Œä¸²å£é€šä¿¡è¿æ¥æˆåŠŸåï¼ˆæ­¤æ—¶ä¼šæ¥æ”¶åˆ°ä¸€å † \x00ï¼‰ï¼Œå†æ¥é€šç”µæºï¼Œè¿™æ ·å°±èƒ½æ¥æ”¶åˆ°å®Œæ•´çš„å¼€æœºä¿¡æ¯äº†ã€‚</p>
<p>38400</p>
<h2 id="UPnPåè®®"><a href="#UPnPåè®®" class="headerlink" title="UPnPåè®®"></a>UPnPåè®®</h2><p>å‚è€ƒï¼š</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="http://www.h3c.com/cn/d_201206/922127_30005_0.htm">UPnPåŸºæœ¬åŸç†ä»¥åŠåœ¨NATä¸­çš„åº”ç”¨-æ–°åä¸‰é›†å›¢-H3C</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/40407669">P2P ç½‘ç»œæ ¸å¿ƒæŠ€æœ¯ï¼šUPnP å’Œ SSDP åè®®</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://www.360doc.com/content/14/1009/17/13468863_415575489.shtml">å›½äº§è·¯ç”±å™¨çš„æ­»ç©´ï¼šUPNPåŠŸèƒ½ä»‹ç»å’Œå±å®³</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.attacker.cc/index.php/archives/113/">UPnP å®‰å…¨ï¼ˆäºŒï¼‰ï¼šUPnP åè®®å…·ä½“æµç¨‹</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/debin/archive/2009/12/01/1614543.html">SSDPï¼Œç®€å•æœåŠ¡å‘ç°æŠ€æœ¯</a></p>
</li>
</ul>
<p>SSDPåè®®æ˜¯UPnPåè®®çš„æ ¸å¿ƒï¼Œä¸»è¦æ˜¯å®Œæˆäº†æœåŠ¡å‘ç°çš„å·¥ä½œã€‚æ¶ˆæ¯ç±»å‹å¯ä»¥åˆ†ä¸º m-search å’Œ notifyã€‚SSDP åè®®æ˜¯ UDP ä¼ è¾“å®ç°çš„ï¼Œè®¾å¤‡ç«¯æ€»æ˜¯åœ¨ <code>239.255.255.250:1900</code> è¿™ä¸ªç»„æ’­åœ°å€ä¸Šç›‘å¬ã€‚å› ä¸ºæ˜¯å»ºç«‹åœ¨æ— è¿æ¥åŸºç¡€ä¸Šçš„ä¼ è¾“ï¼Œæ¶ˆæ¯æ€»æ˜¯ä¼šä¸æ–­åœ°é‡å¤å‘é€ï¼Œæˆ‘æœ¬åœ°æŠ“åŒ…çš„æ—¶å€™å‘ç°ç¡®å®å¦‚æ­¤ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰ä¸€å° PCï¼ˆæ§åˆ¶ç‚¹ï¼‰å’Œè·¯ç”±å™¨ï¼ˆUPnPè®¾å¤‡ï¼‰ã€‚å½“ UpnP è®¾å¤‡è¿›å…¥ç½‘ç»œæ—¶ï¼Œä¼šå¹¿æ’­å‘é€ NOTIFY ä¿¡æ¯ç»™ç½‘ç»œä¸Šçš„æ‰€æœ‰è®¾å¤‡ã€‚å½“PCæ¥å…¥ç½‘ç»œçš„æ—¶å€™ï¼Œé¦–å…ˆé€šè¿‡è·¯ç”±å™¨çš„ DHCP æœåŠ¡è·å¾—å±€åŸŸç½‘å†…çš„ä¸€ä¸ª ipï¼Œæ¥ç€å‘é€ ssdp çš„ m-search æ¶ˆæ¯ï¼Œå¯»æ‰¾ UPnP è®¾å¤‡ã€‚ST å­—æ®µæŒ‡å®šäº†æœç´¢è®¾å¤‡ç±»å‹ï¼ŒæŠ“åŒ…è¿‡ç¨‹ä¸­å‘ç°ä¸€èˆ¬éƒ½æœ‰ç½‘å…³è®¾å¤‡ã€æ ¹è®¾å¤‡è¿™å‡ ç§ç±»å‹ã€‚</p>
<p><img src="https://i.loli.net/2021/10/22/VSYr3y5qhOeRN16.png"></p>
<p>ä¸ºäº†ç†æ¸…æ¥šè¿™äº›åŒ…ä¹‹é—´çš„å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ <a target="_blank" rel="noopener" href="https://upnpy.readthedocs.io/en/latest/">upnpy</a> è¿è¡Œå¯¹åº”çš„æœåŠ¡çœ‹çœ‹ã€‚ä»¥ä¸‹æ˜¯åœ¨ ubuntu ä¸Šè¿è¡Œçš„discoveræœåŠ¡ï¼Œç„¶ååœ¨ VMnet8 ç½‘å¡æˆªå–æµé‡ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import upnpy</span><br><span class="line">upnp=upnpy.UPnP()</span><br><span class="line">devices=upnp.discover()</span><br><span class="line">print(devices)</span><br></pre></td></tr></table></figure>

<p>ä¸€å¼€å§‹æ˜¯ä» ens33 ç½‘å¡çš„ ip å‘å‡º discover åŒ…çš„ï¼Œå¯»æ‰¾çš„æ˜¯æ ¹è®¾å¤‡ã€‚ä½†æˆ‘ä»¬çš„è™šæ‹Ÿæœºç”¨çš„æ˜¯ NAT æ¨¡å¼ï¼Œè¿™ä¸ªåŒ…æœ€ç»ˆä¼šé€šè¿‡ VMnet8 è™šæ‹Ÿç½‘å¡è½¬å‘å‡ºæ¥ã€‚å¯ä»¥çœ‹åˆ°åç»­å‘çš„åŒ…å…¨æ˜¯ä»£ç†è½¬å‘çš„åŒ…ï¼ŒåŠ ä¸Šäº† UASER-AGENT å­—æ®µï¼ŒSTä¹Ÿå˜äº†ã€‚</p>
<p><img src="https://i.loli.net/2021/10/29/unrXtxIRD83djv2.png"></p>
<p>éšååœ¨WLANç½‘å¡æŠ“å–åˆ°ç”±å®ƒè¿›ä¸€æ­¥è½¬å‘çš„åŒ…ï¼ŒSTç±»å‹å˜åŒ–å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ST: urn:schemas-upnp-org:device:InternetGatewayDevice:1\r\n</span><br><span class="line">ST: urn:dial-multiscreen-org:service:dial:1\r\n</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹å‰é¢å®šä¹‰çš„ devices å˜é‡ï¼Œå‘ç°å¯ç”¨è®¾å¤‡ä¸ºç©ºã€‚å› ä¸ºæˆ‘ä»¬çš„æµ‹è¯•ç¯å¢ƒæ˜¯åœ¨æ ¡å›­ç½‘ä¸‹çš„ï¼Œæ²¡æœ‰å¼€å¯upnpæœåŠ¡ï¼Œä¹Ÿæ”¶ä¸åˆ°ç­”åº”åŒ…ã€‚ä½†æ˜¯æˆ‘è¿æ¥äº†è·¯ç”±å™¨çš„ LAN æ¥å£åï¼Œå‘ç° devices è¿˜æ˜¯ç©ºã€‚åœ¨ä»¥å¤ªç½‘ç½‘å¡æˆªå–ä¸åˆ°ssdpæµé‡ï¼Œå€’æ˜¯ä»WLANç½‘å¡è½¬å‘å‡ºå»äº†ï¼Œåº”è¯¥æ˜¯æ²¡è·Ÿ 192.168.1.1 å»ºç«‹èµ· socket è¿æ¥çš„åŸå› ã€‚</p>
<p>å› æ­¤æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨å‘é€ discover çš„ socket åŒ…åˆ°ç½‘å…³ä¸Šæµ‹è¯•ä¸€ä¸‹ã€‚æ ¹æ®å‰é¢çš„æµ‹è¯•æ¥çœ‹ï¼Œæœ¬æœºå‘é€çš„STå­—æ®µåº”è¯¥æ˜¯æ ¹è®¾å¤‡ã€‚å½“è¿™ä¸ªåŒ…è¢«ä»£ç†è½¬å‘åï¼ŒSTå­—æ®µæ‰ä¼šæ”¹å˜ã€‚</p>
<p>è¿™é‡Œçš„è„šæœ¬æˆ‘ç”¨çš„æ˜¯<a target="_blank" rel="noopener" href="https://pythonawesome.com/cisco-rv110w-upnp-stack-overflow/">å‰é¢å‚è€ƒé“¾æ¥</a>ä¸­çš„è„šæœ¬ã€‚æŠŠæ¯ä¸ªå˜é‡è¾“å‡ºä¸€ä¸‹å¤§æ¦‚çŸ¥é“å¾—åˆ°çš„æ˜¯ä»€ä¹ˆå†…å®¹äº†ã€‚ç®€è€Œè¨€ä¹‹å°±æ˜¯ï¼š</p>
<ul>
<li>deviceï¼š<code>Device &lt;(device name)&gt;</code></li>
<li>device.get_services()ï¼šserviceæ•°ç»„ï¼Œæœ‰æœåŠ¡åå’ŒæœåŠ¡idä¸¤ä¸ªå…ƒç´ ï¼Œä¸”åå­—ç›¸ä¼¼ã€‚</li>
<li>service.get_actions()ï¼šactionæ•°ç»„ï¼Œæœ‰æ¯ä¸ªæœåŠ¡å¯¹åº”çš„åŠŸèƒ½å’Œéœ€è¦çš„å‚æ•°ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> upnpy</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> upnpy.ssdp.SSDPDevice <span class="keyword">import</span> SSDPDevice</span><br><span class="line">msg = \</span><br><span class="line">    <span class="string">b&#x27;M-SEARCH * HTTP/1.1\r\n&#x27;</span> \</span><br><span class="line">    <span class="string">b&#x27;HOST:239.255.255.250:1900\r\n&#x27;</span> \</span><br><span class="line">    <span class="string">b&#x27;ST:upnp:rootdevice\r\n&#x27;</span> \</span><br><span class="line">    <span class="string">b&#x27;MX:2\r\n&#x27;</span> \</span><br><span class="line">    <span class="string">b&#x27;MAN:&quot;ssdp:discover&quot;\r\n&#x27;</span> \</span><br><span class="line">    <span class="string">b&#x27;\r\n&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up UDP socket</span></span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM, socket.IPPROTO_UDP)</span><br><span class="line">s.bind((<span class="string">b&quot;192.168.1.100&quot;</span>,<span class="number">9999</span>))</span><br><span class="line">s.settimeout(<span class="number">2</span>)</span><br><span class="line">s.sendto(msg, (<span class="string">b&#x27;239.255.255.250&#x27;</span>, <span class="number">1900</span>))</span><br><span class="line">addr = (<span class="string">&#x27;192.168.1.1&#x27;</span>, <span class="number">1900</span>)</span><br><span class="line">data = <span class="string">b&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=== receive data ===&quot;</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        data, addr = s.recvfrom(<span class="number">65507</span>)</span><br><span class="line">        <span class="built_in">print</span>(addr,data)</span><br><span class="line"><span class="keyword">except</span> socket.timeout:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">device = SSDPDevice(addr, data.decode())<span class="comment">#Device &lt;RV130W&gt;</span></span><br><span class="line">services = device.get_services()</span><br><span class="line">services_id = [services[i].<span class="built_in">id</span>.split(<span class="string">&quot;:&quot;</span>)[-<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(services))]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">id</span> <span class="keyword">in</span> services_id:</span><br><span class="line">    service = device[<span class="built_in">id</span>]</span><br><span class="line">    actions = service.get_actions()</span><br><span class="line">    <span class="keyword">for</span> action <span class="keyword">in</span> actions:</span><br><span class="line">        <span class="keyword">for</span> argument <span class="keyword">in</span> action.arguments:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">id</span>,action.name,argument.name)</span><br></pre></td></tr></table></figure>

<p>ä»è¿è¡Œç»“æœå¯ä»¥çœ‹åˆ°UPnPè®¾å¤‡èƒ½æä¾›çš„æœåŠ¡ï¼ŒåŸºæœ¬éƒ½æ˜¯ä¸ç«¯å£æ˜ å°„ã€å»ºç«‹è¿æ¥ç›¸å…³çš„ã€‚éšåèƒ½æŠ“åˆ°è·¯ç”±å™¨å‘æ¥çš„å›å¤åŒ…ï¼Œè¯´æ˜è¿™å°è·¯ç”±å™¨å°±æ˜¯æ ¹è®¾å¤‡ã€‚</p>
<p><img src="https://i.loli.net/2021/10/29/2iKeYQBAcLau3XZ.png"></p>
<h2 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h2><p>UPnP æ¼æ´å½±å“ä¸¥é‡çš„å…¶ä¸­ä¸€ä¸ªåŸå› æ˜¯å¾ˆå¤šè·¯ç”±å™¨éƒ½é»˜è®¤å¼€æ¬¡è¯¥æœåŠ¡ï¼Œæ€ç§‘å®˜ç½‘é’ˆå¯¹åœäº§è®¾å¤‡æå‡ºçš„è§£å†³æ–¹æ¡ˆæ˜¯ç”¨æˆ·ç¦ç”¨æ­¤æœåŠ¡ã€‚åœ¨ 1.2.44 çš„ç‰ˆæœ¬ä¸‹æµ‹è¯•çš„æ—¶å€™ï¼Œæˆ‘å‘ç° RV130W æ˜¯é»˜è®¤å…³é—­æ­¤æœåŠ¡çš„ã€‚æ‰“å¼€åï¼Œåªæ˜¯å¤šäº†ä¸€ä¸ª 444 ç«¯å£ï¼Œä¼¼ä¹å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> nmap 192.168.1.1</span></span><br><span class="line">Starting Nmap 7.92 ( https://nmap.org ) at 2021-10-29 08:15 PDT</span><br><span class="line">Nmap scan report for router751C7F (192.168.1.1)</span><br><span class="line">Host is up (0.0088s latency).</span><br><span class="line">Not shown: 995 closed tcp ports (conn-refused)</span><br><span class="line">PORT    STATE SERVICE</span><br><span class="line">53/tcp  open  domain</span><br><span class="line">80/tcp  open  http</span><br><span class="line">81/tcp  open  hosts2-ns</span><br><span class="line">443/tcp open  https</span><br><span class="line">444/tcp open  snpp</span><br></pre></td></tr></table></figure>

<p>å°è¯•æ‰«äº†æ‰€æœ‰ç«¯å£ï¼Œä¹Ÿæ²¡æœ‰ç»“æœã€‚ä½†æ˜¯é€šè¿‡å‰é¢çš„æµé‡åˆ†æå¯ä»¥è‚¯å®š UPnP æœåŠ¡æ˜¯å¼€å¯çš„ï¼Œæ‰¾ä¸åˆ°ç«¯å£ä¹Ÿæ²¡æœ‰å…³ç³»ã€‚</p>
<h2 id="æ¼æ´ç¨‹åº"><a href="#æ¼æ´ç¨‹åº" class="headerlink" title="æ¼æ´ç¨‹åº"></a>æ¼æ´ç¨‹åº</h2><blockquote>
<p>åŒä¸€ç±»è·¯ç”±å™¨çš„è®¾è®¡æ€è·¯å¯èƒ½æ˜¯ç›¸ä¼¼çš„ï¼Œå› æ­¤è¿™é‡Œå€ŸåŠ©äº†ã€Š<a target="_blank" rel="noopener" href="https://pythonawesome.com/cisco-rv110w-upnp-stack-overflow/">Cisco RV110w UPnP stack overflow</a>ã€‹è¿›è¡Œåˆ†æã€‚</p>
</blockquote>
<p>åªå¼€å¯äº†NXä¿æŠ¤ã€‚ä»è¿è¡Œç»“æœæ¥çœ‹ï¼Œç¨‹åºç”¨çš„æ˜¯ uClibc åº“ã€‚è¿™ä¸ªåº“å¯ä»¥é€šè¿‡buildrootäº¤å‰ç¼–è¯‘å‡ºæ¥ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> file upnp</span></span><br><span class="line">upnp: ELF 32-bit LSB executable, ARM, EABI4 version 1 (SYSV), dynamically linked, interpreter /lib/ld-uClibc.so.0, stripped</span><br><span class="line"><span class="meta">$</span><span class="bash"> checksec upnp</span></span><br><span class="line">[*] Arch:     arm-32-little</span><br><span class="line">    RELRO:    No RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8000)</span><br><span class="line"><span class="meta">$</span><span class="bash"> qemu-arm -L /usr/arm-linux-gnueabihf ./upnp</span></span><br><span class="line">/lib/ld-uClibc.so.0: No such file or directory</span><br></pre></td></tr></table></figure>

<p>IDA æ‰“å¼€åå‘ç°å¤§éƒ¨åˆ†å‡½æ•°éƒ½å»äº†ç¬¦å·è¡¨ã€‚ä½†æ˜¯ RV110W çš„ upnp æ–‡ä»¶æ²¡æœ‰å»é™¤ï¼Œå¯ä»¥ç”¨ bindiff å¯¹æ¯”ç€è¿˜åŸäº›å‡½æ•°å(å³é”®<code>&gt;import symbols</code>)ã€‚</p>
<p><img src="https://i.loli.net/2021/10/29/yOYzPERo28aQHCs.png"></p>
<p>idaå¯¹ä¸‹é¢è¿™æ®µåœ°å€çš„è§£æå‡ºç°é”™è¯¯ï¼Œæ— æ³•è¿›è¡Œåæ±‡ç¼–ã€‚è§‚å¯Ÿä¸€ä¸‹æ±‡ç¼–æŒ‡ä»¤ï¼ŒåŸºæœ¬æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯ä»PUSHæŒ‡ä»¤å¼€å§‹è§£æå¤±è´¥ã€‚åœ¨è¿™é‡Œå³é”® create functionå°±å¯ä»¥äº†ã€‚</p>
<p><img src="https://i.loli.net/2021/10/28/cjEa7VLIThBpqsA.png"></p>
<p>è¿™æ®µç¨‹åºè¿˜åŸç¬¦å·è¡¨åï¼Œåº”è¯¥æ˜¯ parse_uri å‡½æ•°ï¼Œç»“å°¾è°ƒç”¨äº†ssdp_msearch_responseï¼Œçœ‹æ¥æ˜¯msearchåŒ…å“åº”çš„å¤„ç†ç¨‹åºã€‚ä¸‹é¢è¿™æ®µä»£ç ä½¿ç”¨äº†å±é™©å‡½æ•° strcpyï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(device, <span class="string">&quot;upnp:rootdevice&quot;</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_14;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">memcmp</span>(device, <span class="string">&quot;uuid:&quot;</span>, <span class="number">5u</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">strcpy</span>(uuid, device + <span class="number">5</span>);  <span class="comment">// strcpyæ ˆæº¢å‡º</span></span><br><span class="line">    v7 = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_14;</span><br><span class="line">  &#125;</span><br><span class="line">......</span><br><span class="line">    LABEL_14:</span><br><span class="line">  ssdp_msearch_response(socket, uuid, v7);</span><br></pre></td></tr></table></figure>

<p>ä» <code>&quot;upnp:rootdevice&quot;</code> å¯ä»¥åˆ¤æ–­æ³¨å…¥ç‚¹åœ¨ ST å­—æ®µã€‚ä½†æ˜¯ä¼ å…¥ uuid çš„æ—¶å€™ï¼Œè¿”å›ç›¸åº”åŒ…ä¹‹å‰ä¼šåšä¸€ä¸ªæ£€æŸ¥ã€‚è¿™é‡Œçš„ v11 å…·ä½“æ˜¯ä»€ä¹ˆå‘¢ï¼Œæˆ‘æ˜¯ç”¨gdbè°ƒå‡ºæ¥çš„ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">	<span class="keyword">if</span> ( v11[<span class="number">11</span>] == (<span class="keyword">const</span> <span class="keyword">char</span> *)<span class="number">1</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_7;</span><br><span class="line">	socket = <span class="built_in">strcmp</span>(uuid, (<span class="keyword">const</span> <span class="keyword">char</span> *)v11 + <span class="number">4</span>);</span><br><span class="line">	<span class="keyword">if</span> ( socket )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_7;</span><br><span class="line">	<span class="keyword">return</span> ssdp_response(s, v11, <span class="number">3</span>);</span><br></pre></td></tr></table></figure>



<h1 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h1><p>å‚è€ƒï¼š</p>
<ul>
<li> <a target="_blank" rel="noopener" href="https://ssd-disclosure.com/ssd-advisory-dd-wrt-upnp-buffer-overflow/">SSD Advisory â€“ DD-WRT UPNP Buffer Overflow</a></li>
<li><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/217606">PSV-2020-0211-Netgear-R8300-UPnPæ ˆæº¢å‡ºæ¼æ´åˆ†æ</a></li>
<li><a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/49730">DD-WRT 45723 - UPNP Buffer Overflow (PoC)</a></li>
</ul>
<p>â€¦â€¦</p>
<h2 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h2><p>ï¼ˆè·Ÿä¸Šä¸€ç¯‡çš„æ­¥éª¤å·®ä¸å¤šï¼‰</p>
<p>å…ˆä¸Šä¼  gdbserverã€‚</p>
<p>å‘ç° netstat ä¹Ÿæ²¡æœ‰ -p å‚æ•°ï¼Œä» <a target="_blank" rel="noopener" href="https://busybox.net/downloads/binaries/1.21.1/">busyboxå®˜ç½‘</a> ä¸‹è½½å¯¹åº”çš„ç‰ˆæœ¬å†ä¸Šä¼ ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> uname -a</span></span><br><span class="line">Linux RV130W 2.6.31.1-cavm1 #1 Fri Jun 8 15:31:53 CST 2018 armv6l unknown</span><br><span class="line"><span class="meta">#</span><span class="bash"> ./busybox-armv6l netstat -pantu</span></span><br></pre></td></tr></table></figure>

<p>æµ‹å‡ºåç§»(160)</p>
<p><img src="https://i.loli.net/2021/11/01/8zOBrPe94C2wn6b.png"></p>
<p>å‘çŸ­ä¸€äº›çš„æ•°æ®æ—¶è¿˜æ˜¯ä¼šå´©ï¼Œè¿™æ¬¡æˆ‘ä»¬æŠŠæ–­ç‚¹ä¸‹åœ¨strcpyå‡½æ•° (0xb79c) å’Œ strcmp(0xb59c) .è·Ÿè¿›åˆ†ææ‰¾åˆ°äº† strcmp ç”¨çš„ id å·ï¼Œä¸ºäº†é€šè¿‡æ£€æŸ¥æŠŠå®ƒå†™åœ¨payloadå¤´éƒ¨ï¼Œåé¢å…ˆç”¨ â€˜\x00â€™ å¡«å……ã€‚</p>
<p>0x000B79C: strcpy</p>
<p>0x0000B764: call msearch</p>
<p>0x0000B59C: strcmp</p>
<p>0x0000B5B8: response</p>
<p>0x0000B770: return 0</p>
<p>å‘ç°è¿™ä¸ªè®¾å¤‡è·Ÿ RV110W ä¸€æ ·ï¼Œæ¯ä¸ªç¨‹åºçš„ libc åŸºå€éƒ½æ˜¯å›ºå®šçš„ã€‚æ‰€ä»¥æˆ‘ä»¬åŒæ ·åœ°ç”¨ libc çš„ gadget ï¼Œè€Œä¸ç”¨ç¨‹åºæœ¬èº«çš„ï¼ˆåœ°å€å«â€™\x00â€™ï¼Œä¼šè¢«æˆªæ–­ï¼‰ã€‚</p>
<p><img src="C:\Users\7ee1n\AppData\Roaming\Typora\typora-user-images\image-20211103213837207.png" alt="image-20211103213837207"></p>
<p>en è°ƒç€è°ƒç€win10 ä¸ç»™è¿äº†ï¼Œâ€œæ”¶é›†åˆ°æœªçŸ¥é”™è¯¯ä¿¡æ¯â€emmã€‚è°ƒä¹‹å‰åº”è¯¥æƒ³å¥½æ€ä¹ˆè°ƒï¼Œå‡å°‘é”™è¯¯ï¼Œä¸ç„¶ä¸€ç›´ rebootï¼ˆ</p>
<h2 id="åˆ©ç”¨"><a href="#åˆ©ç”¨" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h2><h1 id="Unsolved"><a href="#Unsolved" class="headerlink" title="Unsolved"></a>Unsolved</h1><blockquote>
<p>å®˜ç½‘å‘å¸ƒçš„æ¼æ´è§£å†³æ–¹æ¡ˆæåˆ°ï¼Œé¼“åŠ±ç”¨æˆ·è¿ç§»åˆ° RV132Wã€RV160 æˆ– RV160W è·¯ç”±å™¨ï¼Œé‚£ä¹ˆä»–ä»¬åœ¨ä»£ç ä¸Šæœ‰ä»€ä¹ˆå˜åŒ–å‘¢ï¼Ÿæ˜¯ç›´æ¥æŠŠ UPnP åŠŸèƒ½åˆ é™¤äº†è¿˜æ˜¯ç”¨å…¶ä»–å‡½æ•°æ›¿ä»£å±é™©å‡½æ•°å‘¢ï¼Ÿ</p>
</blockquote>
<p>7.6å¯¹bindiffçš„æ”¯æŒæŒºå¥½ã€‚</p>
<blockquote>
<p>130Wæœ‰ä¸‰å—èŠ¯ç‰‡ç”¨å±è”½æˆ–æ•£çƒ­ç‰‡å°èµ·æ¥ï¼Œå°šæœªç¡®å®šå…·ä½“æ˜¯ä»€ä¹ˆèŠ¯ç‰‡ã€‚</p>
</blockquote>
<p>æ€•æ‹†åï¼Œå¤ç°å®Œå†æ‹†ã€‚</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/arm/" rel="tag"># arm</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/09/25/ciscoRV110w-CVE-2020-3331/" rel="prev" title="CVEå¤ç° | CiscoRV110W CVE2020-3330/3331">
      <i class="fa fa-chevron-left"></i> CVEå¤ç° | CiscoRV110W CVE2020-3330/3331
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/11/01/hack-lu-2021/" rel="next" title="Hack.lu ctf 2021">
      Hack.lu ctf 2021 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Pre"><span class="nav-number">1.</span> <span class="nav-text">Pre</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#UART%E8%B0%83%E8%AF%95"><span class="nav-number">1.1.</span> <span class="nav-text">UARTè°ƒè¯•</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UPnP%E5%8D%8F%E8%AE%AE"><span class="nav-number">1.2.</span> <span class="nav-text">UPnPåè®®</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F"><span class="nav-number">1.3.</span> <span class="nav-text">ç«¯å£æ‰«æ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E7%A8%8B%E5%BA%8F"><span class="nav-number">1.4.</span> <span class="nav-text">æ¼æ´ç¨‹åº</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="nav-number">2.</span> <span class="nav-text">æ¼æ´åˆ©ç”¨</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B0%83%E8%AF%95"><span class="nav-number">2.1.</span> <span class="nav-text">è°ƒè¯•</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%A9%E7%94%A8"><span class="nav-number">2.2.</span> <span class="nav-text">åˆ©ç”¨</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Unsolved"><span class="nav-number">3.</span> <span class="nav-text">Unsolved</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">7ee1n</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">13</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://custuvo.github.io/" title="https:&#x2F;&#x2F;custuvo.github.io&#x2F;" rel="noopener" target="_blank">â¤Cu3tuv0â¤</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://brooke-hub.github.io/" title="https:&#x2F;&#x2F;brooke-hub.github.io&#x2F;" rel="noopener" target="_blank">Wendy</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://r1nd0.github.io/" title="https:&#x2F;&#x2F;r1nd0.github.io&#x2F;" rel="noopener" target="_blank">R1nd0ç¥</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2021 â€“ 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">7ee1n</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> å¼ºåŠ›é©±åŠ¨
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : true,
      notify     : true,
      appId      : 'gf3X3bhGvA1TTaRXpIJrXU8Q-gzGzoHsz',
      appKey     : 'PhQvOaVhLbUmODpCMAScvMqy',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":180,"height":360},"dialog":{"enable":false},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
